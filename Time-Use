#Average childcare duration for people that work more than 360 mins, by sex 
* Code for female
use "E:\PSE\timeuse.dta", clear
keep if SEX == 2 & DUR08 >= 360 & CXRFLAG == 1
egen childcare = total(DUR27 + DUR28)
egen numavw = total(childcare * WGHT_PER)
egen denavw = total(WGHT_PER)
gen avchildcarew = numavw / denavw

* Code for male
use "E:\PSE\timeuse.dta", clear
keep if SEX == 1 & DUR08 >= 360 & CXRFLAG == 1
egen childcare = total(DUR27 + DUR28)
egen numavm = total(childcare * WGHT_PER)
egen denavm = total(WGHT_PER)
gen avchildcarem = numavm / denavm





#T-tests (second section
local results ""
forval i = 1/63 {
    local dur_var DUR`i'
    if `i' < 10 local dur_var DUR0`i'

    ttest `dur_var', by(SEX)

    if r(p) < 0.05 {
        local results "`results'`dur_var' "
        
        if r(t) > 0 {
            di "`dur_var': Male has a higher average (p < 0.05)"
        }
        else {
            di "`dur_var': Female has a higher average (p < 0.05)"
        }
    }
}

di "Variables with significant differences by sex (p < 0.05): `results'"



use "E:\PSE\timeuse.dta", clear
svyset [pweight=WGHT_PER], vce(linearized)
keep if SLM_01 >= 1 & SLM_01 <= 5
gen MATR = (MARSTAT == 1 & PHSDFLG == 1)
summarize SLM_01 [aweight=WGHT_PER]
scalar weighted_avg = r(mean)
collapse (mean) SLM_01, by(SEX MATR)
gen ratio_SLM_01 = SLM_01 / weighted_avg
format SLM_01 ratio_SLM_01 %9.2f
list

use "E:\PSE\timeuse.dta", clear
svyset [pweight=WGHT_PER], vce(linearized)
keep if SRH_110 >= 1 & SRH_110 <= 5
gen MATR = (MARSTAT == 1 & PHSDFLG == 1)
summarize SRH_110 [aweight=WGHT_PER]
scalar weighted_avg = r(mean)
collapse (mean) SRH_110, by(SEX MATR)
gen ratio_SRH_110 = SRH_110 / weighted_avg
format SRH_110 ratio_SRH_110 %9.2f
list

use "E:\PSE\timeuse.dta", clear
svyset [pweight=WGHT_PER], vce(linearized)
keep if SRH_115 >= 1 & SRH_115 <= 5
gen MATR = (MARSTAT == 1 & PHSDFLG == 1)
summarize SRH_115 [aweight=WGHT_PER]
scalar weighted_avg = r(mean)
collapse (mean) SRH_115, by(SEX MATR)
gen ratio_SRH_115 = SRH_115 / weighted_avg
format SRH_115 ratio_SRH_115 %9.2f
list

#interesting variables: LIVARR08 year and living with parents 
#questions: better matr and couplebefore or partner living in the household. Number of members or children at home. CHLDDUR or UH_01/ UH_03/ ADLTDUR or UH_05+UH_06. Should I inlcude disability status? If so, only mental or everyone
#married+living common law
gen MATR = (MARSTAT == 1| MARSTAT == 2)
#widowed+separated+divorced
gen couplebefore = (MARSTAT == 3 | MARSTAT == 4 | MARSTAT == 5)
gen homosexualcouple = (PRTYPEC ==3)
gen youngestchildage = AGECXRYG
replace youngestchildage = . if AGECXRYG == 96
gen agedifferencepartner = AGEPRGRD
replace agedifferencepartner = . if AGEPRGRD == 96
#maybe set a limit age in the command below or use LIVARR08
gen livingwithoneparent = (PARNUM == 2)
gen feelrushed = GTU_110
replace feelrushed = . if GTU_110 == 97 | GTU_110 == 98
gen feelrushed = GTU_130
replace feelrushed = . if GTU_130 == 97 | GTU_130 == 98 | GTU_130 == 99
gen new_sleep1s = SLEEP1S
replace new_sleep1s = cond(inlist(substr(new_sleep1s, 1, 2), "00", "01", "02", "03", "04"), new_sleep1s, cond(SLEEP1D > 899, string(real(new_sleep1s) + 1200, "%05.0f"), new_sleep1s))
replace new_sleep1s = cond(inlist(substr(new_sleep1s, 1, 2), "00", "01", "02", "03", "04"), string(real(new_sleep1s) + 2400, "%04.0f"), new_sleep1s)
#TCS_110 TCS_120 TCS_130 TCS_140 TCS_150 TCS_160 TCS_170 TCS_180 TCS_190 TCS_200
gen timecrunch = TIMECR
replace timecrunch = . if TIMECR == 99
gen timecrunch = TIMECR
replace timecrunch = . if TIMECR == 99
gen swell_being = SLM_01
replace swell_being = . if SLM_01 == 97| SLM_01 == 98 | SLM_01 == 99
gen shealth = SRH_110
replace shealth = . if SRH_110 == 7| SRH_110 == 8 | SRH_110 == 9
gen smentalhealth = SRH_115
replace smentalhealth = . if SRH_115 == 7| SRH_115 == 8 | SRH_115 == 9
gen mentaldisabilitystatus = DMEN_FL
replace mentaldisabilitystatus = . if DMEN_FL == 7| DMEN_FL == 8 | DMEN_FL == 9


#include: PRV
regress smentalhealth AGEGR10 SEX HSDSIZEC PHSDFLG AGEPRGRD MATR couplebefore homosexualcouple CHINHSDC youngestchildage agedifferencepartner feelrushed SLEEPDUR PERSDUR PDWKDUR LKWKDUR SCHLDUR HSWKDUR CHLDDUR ADLTDUR OHHLDUR SHOPDUR CIVICDUR EVENTDUR SPRTSDUR ACTLDUR SOCPRDUR SOCTCDUR TVDUR READDUR OTHLDUR TRANSDUR BREAKDUR MEALSDUR OTHERDUR new_sleep1s TIMECR shealth mentaldisabilitystatus    
